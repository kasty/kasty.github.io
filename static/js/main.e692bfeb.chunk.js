(this["webpackJsonpcovid19-auto-generator"]=this["webpackJsonpcovid19-auto-generator"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n(10),c=n.n(r),i=n(50),s=n.n(i),o=(n(73),n(74),n(75),function(){return Object(a.jsxs)("h1",{className:"text-center mb-4",children:["G\xe9n\xe9rateur d'autorisation ",Object(a.jsx)("span",{className:"badge badge-warning",children:"COVID-19"})]})}),l=n(20),u=n(15),d=n.n(u),h=n(22),f=n(51),m=n.n(f),p=function(e){var t=e.currentUser,n=void 0===t?"":t,r=e.users,c=void 0===r?{}:r,i=e.onChange;return Object(a.jsxs)("h2",{className:"mb-4",children:["Je suis",Object(a.jsxs)("select",{id:"user",name:"user",className:"custom-select custom-select-lg",value:n,onChange:i,children:[Object(a.jsx)("option",{value:"",children:"..."}),Object.keys(c).map((function(e,t){var n=e.charAt(0).toUpperCase()+e.slice(1);return Object(a.jsxs)("option",{value:e,children:[n,c&&c[e]&&c[e].profile&&c[e].profile.emoji?c[e].profile.emoji:null]},e)}))]})]})},j={reasonsList:{travail:{title:"au boulot",emoji:"\ud83d\udda5"},famille:{title:"m'occuper de la famille",emoji:"\ud83d\udcaa\ud83c\udffc"},achats:{title:"faire les courses",emoji:"\ud83d\uded2"},sport_animaux:{title:"prendre l'air",emoji:" \u2614\ufe0f"},sante:{title:"chez le doc (glups)",emoji:"\ud83e\udd12"},handicap:{title:"me d\xe9placer en situation de handicap",emoji:"\ud83e\uddbd"},convocation:{title:"\xe0 une convocation",emoji:"\ud83d\udcc4"},missions:{title:"participer \xe0 une mission d'int\xe9r\xeat g\xe9n\xe9ral",emoji:"\ud83d\udd27"},enfants:{title:"chercher les enfants \xe0 l'\xe9cole",emoji:"\ud83e\uddf8"}}},b=function(e){var t=e.currentReason,n=e.onChange,r=e.reasons;return Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Je vais ..."}),Object(a.jsx)("div",{className:"custom-control custom-radio",children:Object.keys(j.reasonsList).map((function(e){var c,i;return r&&(null===r||void 0===r?void 0:r.includes(e))||null==r?Object(a.jsxs)("p",{id:"reason-".concat(e),className:"choice mt-3 mb-3",children:[Object(a.jsx)("input",{type:"radio",name:"field-reason",id:e,value:e,className:"custom-control-input",checked:t===e,onChange:n}),Object(a.jsxs)("label",{htmlFor:e,className:"custom-control-label",children:[null===(c=j.reasonsList[e])||void 0===c?void 0:c.title," ",null===(i=j.reasonsList[e])||void 0===i?void 0:i.emoji]})]},e):null}))})]})},g=(n(30),["for","inputmode","minlength","maxlength","min","max","pattern"]);function v(e,t){var n=function(e,t){var n=document.createElement(e);return g.forEach((function(e){t&&e in t&&t[e]&&n.setAttribute(e,t[e]),t&&delete t[e]})),Object.assign(n,t),n}("a"),a=URL.createObjectURL(e);n.href=a,n.download=t,document.body.appendChild(n),n.click()}var x=n(52),O=n.n(x);function y(e){return O.a.toDataURL(e,{errorCorrectionLevel:"M",type:"image/png",quality:.92,margin:1})}var w=n(29),C={travail:578,achats:533,sante:477,famille:435,handicap:396,sport_animaux:358,convocation:295,missions:255,enfants:211};function S(e,t,n){return N.apply(this,arguments)}function N(){return(N=Object(h.a)(d.a.mark((function e(t,n,a){var r,c,i,s,o,l,u,h,f,m,p,j,b,g,v,x,O,S,N,k,D,F,A;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Date,c=r.toLocaleDateString("fr-FR"),i=r.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}).replace(":","h"),s=t.lastname,o=t.firstname,l=t.birthday,u=t.placeofbirth,h=t.address,f=t.zipcode,m=t.city,p=t.datesortie,j=t.heuresortie,b=["Cree le: ".concat(c," a ").concat(i),"Nom: ".concat(s),"Prenom: ".concat(o),"Naissance: ".concat(l," a ").concat(u),"Adresse: ".concat(h," ").concat(f," ").concat(m),"Sortie: ".concat(p," a ").concat(j),"Motifs: ".concat(n)].join(";\n "),e.next=7,fetch(a).then((function(e){return e.arrayBuffer()}));case 7:return g=e.sent,e.next=10,w.PDFDocument.load(g);case 10:return(v=e.sent).setTitle("COVID-19 - D\xe9claration de d\xe9placement"),v.setSubject("Attestation de d\xe9placement d\xe9rogatoire"),v.setKeywords(["covid19","covid-19","attestation","d\xe9claration","d\xe9placement","officielle","gouvernement"]),v.setProducer("DNUM/SDIT"),v.setCreator(""),v.setAuthor("Minist\xe8re de l'int\xe9rieur"),x=v.getPages()[0],e.next=20,v.embedFont(w.StandardFonts.Helvetica);case 20:return O=e.sent,(S=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:11;x.drawText(e,{x:t,y:n,size:a,font:O})})("".concat(o," ").concat(s),119,696),S(l,119,674),S(u,297,674),S("".concat(h," ").concat(f," ").concat(m),133,652),n.split(", ").forEach((function(e){S("x",78,C[e],18)})),(N=L(O,t.city,83,7,11))||(alert('Le nom de la ville risque de ne pas \xeatre affich\xe9 correctement en raison de sa longueur. Essayez d\'utiliser des abr\xe9viations ("Saint" en "St." par exemple) quand cela est possible.'),N=7),S(t.city,105,177,N),S("".concat(t.datesortie),91,153,11),S("".concat(t.heuresortie),264,153,11),e.next=34,y(b);case 34:return k=e.sent,e.next=37,v.embedPng(k);case 37:return D=e.sent,x.drawImage(D,{x:x.getWidth()-156,y:100,width:92,height:92}),v.addPage(),(F=v.getPages()[1]).drawImage(D,{x:50,y:F.getHeight()-350,width:300,height:300}),e.next=44,v.save();case 44:return A=e.sent,e.abrupt("return",new Blob([A],{type:"application/pdf"}));case 46:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,n,a,r){for(var c=r,i=e.widthOfTextAtSize(t,r);i>n&&c>a;)i=e.widthOfTextAtSize(t,--c);return i>n?null:c}var k=n.p+"static/media/certificate.eeff7ddd.pdf",D=function(){var e=function(){var e=Object(h.a)(d.a.mark((function e(){var t,n,a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N||!N.profile){e.next=13;break}return t=N.profile,n=new Date,t.datesortie="".concat(n.getDate(),"/").concat(n.getMonth()+1,"/").concat(n.getFullYear()),t.heuresortie="".concat(n.getHours(),":").concat(String(n.getMinutes()).padStart(2,"0")),e.next=7,S(t,O,k);case 7:a=e.sent,r=n.toLocaleDateString("fr-CA"),c=n.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}).replace(":","-"),v(a,"attestation-".concat(r,"_").concat(c,".pdf")),e.next=13;break;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=c.a.useState(""),n=Object(l.a)(t,2),i=n[0],s=n[1],o=c.a.useState(null),u=Object(l.a)(o,2),f=u[0],j=u[1],g=c.a.useState(""),x=Object(l.a)(g,2),O=x[0],y=x[1],w=c.a.useState(null),C=Object(l.a)(w,2),N=C[0],L=C[1],D=c.a.useState(null),F=Object(l.a)(D,2),A=F[0],U=F[1];return Object(r.useEffect)((function(){if(A)if(""!==i){var e=A.users[i];L(e),e&&e.settings&&e.settings.defaultChoice?y(e.settings.defaultChoice):y(e.settings.choices[0])}else s(document.location.search.replace("?p=","")||(A&&A.defaultUser&&A.users&&A.users[A.defaultUser]?A.defaultUser:""))}),[A,i]),Object(r.useEffect)((function(){(function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat(document.location.origin).concat(document.location.pathname,"/users.json")).then((function(e){U(e.data),j(null)})).catch((function(e){j("Une erreur s'est produite dans le chargement des donn\xe9es"),console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.jsxs)("form",{children:[f?Object(a.jsx)("div",{className:"alert alert-danger",children:f}):null,Object(a.jsx)(p,{users:A&&A.users?A.users:{},currentUser:i,onChange:function(e){s(e.target.value)}}),Object(a.jsx)(b,{currentReason:O,reasons:N&&N.settings&&N.settings.choices?N.settings.choices:null,onChange:function(e){y(e.currentTarget.value)}}),Object(a.jsx)("button",{type:"button",className:"btn btn-info btn-lg btn-block",id:"generate-btn",onClick:e,children:"G\xe9n\xe9rer"})]})},F=function(){return Object(a.jsx)("p",{className:"text-center",children:Object(a.jsxs)("small",{children:["Ce projet a \xe9t\xe9 r\xe9alis\xe9 \xe0 partir du projet officiel disponible sur le ",Object(a.jsx)("a",{href:"https://github.com/LAB-MI/attestation-deplacement-derogatoire-q4-2020",children:"d\xe9p\xf4t du Minit\xe8re de l'Int\xe9rieur"}),Object(a.jsx)("br",{}),"Auteur : ",Object(a.jsx)("a",{href:"https://www.mariegosse.fr",children:"Marie Goss\xe9"})," / ",Object(a.jsx)("a",{href:"https://github.com/kasty/covid19-auto-generator",children:"Github"})]})})};var A=function(){return Object(a.jsxs)("div",{id:"app",className:"App container-md",children:[Object(a.jsx)("div",{className:"mx-auto card",id:"main",children:Object(a.jsxs)("div",{className:"card-body text-center",children:[Object(a.jsx)(o,{}),Object(a.jsx)(D,{})]})}),Object(a.jsx)(F,{})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,128)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(A,{})}),document.getElementById("root")),U()},73:function(e,t,n){},75:function(e,t,n){}},[[127,1,2]]]);
//# sourceMappingURL=main.e692bfeb.chunk.js.map